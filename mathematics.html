<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mathematics | REAL Learning</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; margin:0; background:#f5f5f5; color:#222; line-height:1.6; }
    header { background:#111; color:#fff; }
    section { padding:40px 20px; max-width:900px; margin:auto; }
    .navbar { display:flex; justify-content:space-between; background:#000; padding:12px 20px; }
    .logo { color:white; font-weight:bold; }
    .menu a { color:white; margin-left:15px; text-decoration:none; }
    footer { background:#222; color:#ccc; text-align:center; padding:20px; }
    .block { background:white; padding:20px; margin-bottom:20px; border-left:5px solid #111; }
    .toggle-btn { background:#111; color:#fff; border:none; padding:8px 14px; cursor:pointer; margin-top:8px; }
    .toggle-btn:hover { background:#333; }
    .class-content { display:none; }
    .chapter-list { display:none; margin-top:15px; padding-left:20px; }
    .module-btn.locked { background:#666; cursor:not-allowed; }
    #progressBarContainer { background:#ddd; width:100%; height:20px; border-radius:4px; margin-bottom:10px; }
    #progressBar { background:#4caf50; width:0%; height:100%; border-radius:4px; transition: width 0.3s; }
  </style>
</head>

<body>

<header>
  <nav class="navbar">
    <div class="logo">REAL Learning</div>
    <div class="menu">
      <a href="index.html">Home</a>
      <a href="subjects.html">Subjects</a>
    </div>
  </nav>
</header>

<section>
  <h1>Mathematics</h1>
  <p>Mathematics is the study of structure, relationships, and necessity.</p>

  <label><strong>Select Class:</strong></label><br>
  <select id="classSelect" onchange="showClassContent()">
    <option value="">-- Choose Class --</option>
    <option value="5">Class 5</option>
  </select>
</section>

<section id="class5" class="block class-content">
  <h2>Class 5 Mathematics</h2>
  <button class="toggle-btn" onclick="toggleChapters('chapters5')">View Chapter Index</button>
  <ul id="chapters5" class="chapter-list">
    <li>
      <button class="toggle-btn" onclick="openChapter('travellers1')">We the Travellers â€“ I</button>
    </li>
  </ul>
</section>

<!-- MODULE VIEWER -->
<section id="chapterModuleBox" class="block" style="display:none;">
  <h3 id="chapterTitle"></h3>

  <!-- MODULE LIST -->
  <div id="moduleList"></div>

  <!-- LESSON ENGINE -->
  <div id="moduleEngine" style="display:none; margin-top:20px;">
    <div id="progressBarContainer">
      <div id="progressBar"></div>
    </div>

    <h4 id="mTitle"></h4>
    <p id="mText"></p>

    <p><strong>Question:</strong></p>
    <p id="mQuestion"></p>

    <input id="mAnswer" style="width:100%; padding:8px;">
    <button class="toggle-btn" onclick="submitModuleAnswer()">Submit</button>

    <p id="mFeedback"></p>
    <p><strong>Score:</strong> <span id="mScore">0</span></p>
  </div>
</section>

<footer>
  <p>Â© 2026 REAL Learning</p>
</footer>

<script>
/* ===== CLASS SELECTION & CHAPTER ===== */
function showClassContent() {
  document.querySelectorAll('.class-content').forEach(s => s.style.display='none');
  const c = document.getElementById('classSelect').value;
  if(c) document.getElementById('class'+c).style.display='block';
}
function toggleChapters(id){
  const el=document.getElementById(id);
  el.style.display = el.style.display==='block'? 'none':'block';
}

/* ===== GLOBAL MODULE REGISTRY ===== */
window.REAL_MODULES = window.REAL_MODULES || {};

/* ===== MODULE ENGINE ===== */
let activeChapter, activeModule, lessonIndex=0, score=0, moduleIndex=0;

function openChapter(key){
  activeChapter = REAL_MODULES[key];
  if(!activeChapter) return alert("Modules coming soon.");

  document.getElementById("chapterModuleBox").style.display="block";
  document.getElementById("chapterTitle").innerText = activeChapter.title;

  const list = document.getElementById("moduleList");
  list.innerHTML = "";

  // Track module unlock: first module unlocked by default
  activeChapter.modules.forEach((m,i)=>{
    const b = document.createElement("button");
    b.className="toggle-btn module-btn";
    b.innerText = m.name;

    // lock logic: previous module must be completed
    if(i>0 && !activeChapter.modules[i-1].completed){
      b.classList.add("locked");
      b.disabled = true;
    }

    b.onclick = ()=>{
      if(b.disabled) return;
      startModule(i);
    };
    list.appendChild(b);
  });
}

function startModule(i){
  activeModule = activeChapter.modules[i];
  moduleIndex = i;
  lessonIndex = 0;
  score = 0;
  document.getElementById("mScore").innerText = score;
  document.getElementById("mAnswer").style.display="block";
  document.getElementById("moduleEngine").style.display="block";
  loadLesson();
}

function loadLesson(){
  const l = activeModule.lessons[lessonIndex];
  document.getElementById("mTitle").innerText = l.title;
  document.getElementById("mText").innerText = l.text;
  document.getElementById("mQuestion").innerText = l.question;
  document.getElementById("mAnswer").value="";
  document.getElementById("mFeedback").innerText="";

  // Update progress bar
  const progressPercent = Math.floor((lessonIndex / activeModule.lessons.length) * 100);
  document.getElementById("progressBar").style.width = progressPercent + "%";
}

function submitModuleAnswer(){
  const a = document.getElementById("mAnswer").value;
  const lesson = activeModule.lessons[lessonIndex];

  if(lesson.check(a)){
    score += lesson.points || 10;
    document.getElementById("mScore").innerText = score;
    lessonIndex++;

    if(lessonIndex < activeModule.lessons.length){
      loadLesson();
      document.getElementById("mFeedback").innerText="âœ… Correct! Next lesson unlocked.";
    } else {
      document.getElementById("mTitle").innerText="ðŸŽ‰ Module Completed";
      document.getElementById("mText").innerText="You have completed this module.";
      document.getElementById("mQuestion").innerText="";
      document.getElementById("mAnswer").style.display="none";
      document.getElementById("mFeedback").innerText="";
      document.getElementById("progressBar").style.width = "100%";

      // Mark module completed
      activeModule.completed = true;
      // refresh module buttons to unlock next module
      openChapter(activeChapter.id || 'travellers1');
    }
  } else {
    document.getElementById("mFeedback").innerText="âŒ Try again.";
  }
}
</script>

<!-- LOAD MODULE FILES -->
<script src="modules/class5_travellers1.js"></script>
<script src="modules/class5_travellers2.js"></script>
<script src="modules/class5_travellers3.js"></script>
</body>
</html>
